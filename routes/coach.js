var Db=require("../db"),$=require("jquery-deferred"),Coach=require("../controllers/coach");module.exports={hire:{params:{id:{required:!0,parseMethod:parseInt}},handler:function(e,r){var a=$.Deferred(),c=e.player["private"].coach;return c&&Coach.dec(c),Coach.inc(r.id),e.player["private"].coach=r.id,e.isDirty=!0,a.resolve({success:!0,id:r.id}),a}},fire:{handler:function(e){var r=$.Deferred(),a=e.player["private"].coach;return a&&Coach.dec(a),delete e.player["private"].coach,e.isDirty=!0,r.resolve({success:!0}),r}},getPay:{handler:function(e){var r=$.Deferred(),a={success:!0},c=e.player._id,i=e.player["public"].coach;return i.s&&(e.player["private"].money+=i.s,a.money=i.s,e.player["public"].coach.s=0,Coach.getPay(c),e.isDirty=!0),r.resolve(a),r}}};