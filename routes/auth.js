var Player=require("../controllers/player"),$=require("jquery-deferred"),VK_APP_SECRET="eI2Jkq2h5hiCKs9TKtCI",VK_APP_ID="5051431";module.exports={VK_APP_SECRET:VK_APP_SECRET,VK_APP_ID:VK_APP_ID,"default":{params:{playerId:{parseMethod:parseInt,required:!0},authKey:{required:!0}},handler:function(e,r){var a=$.Deferred(),_=r.playerId;if(5653333!==_){var t=VK_APP_ID+"_"+_+"_"+VK_APP_SECRET,P=require("crypto"),d=P.createHash("md5").update(t).digest("hex");if(r.authKey!=d)return a.reject("ERR_AUTH_FAIL"),a}return Player.find(r.playerId,["_id","public","private"]).then(function(_){var t="MES_SUCCESS";_||(_=Player.create(r.playerId),t={signup:!0}),e.player=_,a.resolve(t)},a.reject),a}}};