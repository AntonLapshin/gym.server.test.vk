var Db=require("../db"),$=require("jquery-deferred"),_rates={money:20,gold:1},_bonus=.05;module.exports={"default":{params:{type:{required:!0},id:{required:!0,parseMethod:parseInt},real:{required:!0,parseMethod:parseInt}},handler:function(e,r){var s=r.type,a=r.id,i=r.real,t={success:!0};if("gyms"===s||"food"===s||"rest"===s||"stimul"===s)e.player["private"][s].push(a),t.purchase={type:s,id:a,success:!0};else if("exercises"===s)e.player["public"][s].push({_id:a}),t.purchase={type:s,id:a,success:!0};else if("money"===s||"gold"===s){var u=Math.floor(i*_rates[s]+i*_bonus*(i*_rates[s]));e.player["private"][s]+=u,t[s]=u}var d=$.Deferred();return e.pendingPayment=null,e.isDirty=!0,d.resolve(t),d}}};