var Db=require("../../db"),GymDb=require("../../gymdb/gymdb"),Job=require("../../routes/job"),DateHelper=require("../../controllers/date"),PLAYER_ID_TEST=0;module.exports={setUp:function(e){GymDb.init().then(e,console.log)},tearDown:function(e){GymDb.close().then(e,console.log)},getSuccess:function(e){var o={auth:{id:PLAYER_ID_TEST,job:{}}},t=DateHelper.setNextTime(new Date,-Job.PERIOD-1);Job.setNextTime(PLAYER_ID_TEST,t).then(function(){return Job.get(o)},console.log).then(function(t){e.equal(!!o.auth.job.time,!0),e.equal(Job.WEIGHT_MIN<=t&&t<=Job.WEIGHT_MAX,!0),e.done()},console.log)},getFail:function(e){var o={auth:{id:PLAYER_ID_TEST,job:{}}},t=DateHelper.addMinutes(new Date,1);Job.setNextTime(PLAYER_ID_TEST,t).then(function(){return Job.get(o)},console.log).then(function(o){e.equal(o,Job.MES_TOOEARLY),e.done()},console.log)},completeSuccess:function(e){var o={auth:{id:PLAYER_ID_TEST,job:{}}},t=DateHelper.setNextTime(new Date,-Job.PERIOD-1);Job.setNextTime(PLAYER_ID_TEST,t).then(function(){return Job.get(o)},console.log).then(function(){return e.equal(!!o.auth.job.time,!0),Job.complete(o)},console.log).then(function(t){e.equal(!!o.auth.job.time,!1),e.equal(t==Job.MONEY,!0),e.done()},console.log)},completeNotStarted:function(e){var o={auth:{id:PLAYER_ID_TEST,job:{}}},t=DateHelper.addMinutes(new Date,1);Job.setNextTime(PLAYER_ID_TEST,t).then(function(){return Job.complete(o)},console.log).then(function(o){e.equal(o,Job.MES_NOTSTARTED),e.done()},console.log)},completeTimeIsUp:function(e){var o={auth:{id:PLAYER_ID_TEST,job:{}}},t=DateHelper.setNextTime(new Date,-Job.PERIOD-1);Job.setNextTime(PLAYER_ID_TEST,t).then(function(){return Job.get(o)},console.log).then(function(){return e.equal(!!o.auth.job.time,!0),o.auth.job.time=DateHelper.addSeconds(o.auth.job.time,-Job.TIMER-10),Job.complete(o)},console.log).then(function(o){e.equal(o,Job.MES_TIMEISUP),e.done()},console.log)}};